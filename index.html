<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI-Powered Smart Educational Platform - Advanced</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark.min.css">
  <style>
    :root {
      --bg: #0f2027;
      --bg-light: #1e2b35;
      --text: #ffffff;
      --primary: #00bcd4;
      --primary-dark: #0097a7;
      --accent: #ff4081;
      --accent-dark: #f50057;
      --success: #4caf50;
      --warning: #ff9800;
      --info: #2196f3;
      --font: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      --radius: 8px;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    /* Existing styles remain the same, adding new ones below */
    
    .ai-chat-container {
      background: var(--bg-light);
      border-radius: var(--radius);
      padding: 1rem;
      margin-top: 1rem;
      max-height: 300px;
      overflow-y: auto;
    }

    .chat-message {
      margin-bottom: 1rem;
      padding: 0.8rem;
      border-radius: var(--radius);
      max-width: 80%;
    }

    .user-message {
      background: var(--primary);
      margin-left: auto;
    }

    .ai-message {
      background: var(--bg);
      border: 1px solid var(--primary);
    }

    .chat-input-container {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
    }

    .chat-input {
      flex: 1;
      padding: 0.8rem;
      border-radius: var(--radius);
      border: none;
      background: var(--bg);
      color: var(--text);
    }

    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }

    .feature-card {
      background: rgba(255, 255, 255, 0.05);
      padding: 1rem;
      border-radius: var(--radius);
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 1px solid transparent;
    }

    .feature-card:hover {
      transform: translateY(-3px);
      border-color: var(--primary);
      background: rgba(255, 255, 255, 0.08);
    }

    .feature-icon {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      color: var(--primary);
    }

    .smart-suggestions {
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--radius);
      padding: 1rem;
      margin-top: 1rem;
    }

    .suggestion-item {
      padding: 0.5rem;
      margin: 0.3rem 0;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .suggestion-item:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .code-metrics {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }

    .metric-card {
      background: rgba(255, 255, 255, 0.05);
      padding: 1rem;
      border-radius: var(--radius);
      text-align: center;
    }

    .metric-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--primary);
      margin: 0.5rem 0;
    }

    .learning-path {
      background: var(--bg-light);
      border-radius: var(--radius);
      padding: 1rem;
      margin-top: 1rem;
    }

    .path-step {
      display: flex;
      align-items: center;
      padding: 0.8rem;
      margin: 0.5rem 0;
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--radius);
    }

    .step-number {
      background: var(--primary);
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 1rem;
      font-weight: bold;
    }

    .collaboration-panel {
      background: var(--bg-light);
      border-radius: var(--radius);
      padding: 1rem;
      margin-top: 1rem;
    }

    .user-list {
      margin-top: 1rem;
    }

    .user-item {
      display: flex;
      align-items: center;
      padding: 0.5rem;
      margin: 0.3rem 0;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    .user-avatar {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 0.8rem;
      font-size: 0.8rem;
    }

    .progress-ring {
      transform: rotate(-90deg);
    }

    .progress-ring-circle {
      transition: stroke-dashoffset 0.3s;
    }

    .ai-insights {
      background: var(--bg-light);
      border-radius: var(--radius);
      padding: 1rem;
      margin-top: 1rem;
    }

    .insight-item {
      padding: 0.8rem;
      margin: 0.5rem 0;
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--radius);
      border-left: 3px solid var(--info);
    }

    .code-compare {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin-top: 1rem;
    }

    .compare-panel {
      background: var(--bg-light);
      border-radius: var(--radius);
      padding: 1rem;
    }

    .version-control {
      background: var(--bg-light);
      border-radius: var(--radius);
      padding: 1rem;
      margin-top: 1rem;
    }

    .version-item {
      padding: 0.8rem;
      margin: 0.5rem 0;
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--radius);
      cursor: pointer;
    }

    .version-item.active {
      border-left: 3px solid var(--success);
    }
  </style>
</head>
<body>

  <h1>ü§ñ AI-Powered Smart Educational Platform - Advanced</h1>

  <div class="tabs">
    <div class="tab active" onclick="switchTab('code-generation')">Code Generation</div>
    <div class="tab" onclick="switchTab('code-execution')">Code Execution</div>
    <div class="tab" onclick="switchTab('ai-features')">AI Features</div>
    <div class="tab" onclick="switchTab('ai-chat')">AI Assistant</div>
    <div class="tab" onclick="switchTab('learning-path')">Learning Path</div>
    <div class="tab" onclick="switchTab('collaboration')">Collaboration</div>
    <div class="tab" onclick="switchTab('history')">History</div>
  </div>

  <!-- Existing panels remain the same, adding new ones below -->

  <!-- AI Chat Assistant Panel -->
  <div class="card tab-content" id="ai-chat" style="display: none;">
    <div class="card-header">
      <i class="fas fa-robot"></i>
      <h2>AI Programming Assistant</h2>
    </div>
    
    <div class="ai-chat-container" id="chat-messages">
      <div class="chat-message ai-message">
        <strong>AI Assistant:</strong> Hello! I'm your AI programming assistant. I can help explain concepts, debug code, suggest improvements, and answer any programming questions you have!
      </div>
    </div>
    
    <div class="chat-input-container">
      <input type="text" class="chat-input" id="chat-input" placeholder="Ask me anything about programming..." />
      <button onclick="sendChatMessage()" class="btn-primary">
        <i class="fas fa-paper-plane"></i>
      </button>
    </div>
    
    <div class="smart-suggestions">
      <h4>Quick Questions:</h4>
      <div class="suggestion-item" onclick="askSuggestion('How do I fix this error?')">How do I fix this error?</div>
      <div class="suggestion-item" onclick="askSuggestion('Explain this code')">Explain this code</div>
      <div class="suggestion-item" onclick="askSuggestion('Optimize this function')">Optimize this function</div>
      <div class="suggestion-item" onclick="askSuggestion('Show me an example')">Show me an example</div>
    </div>
  </div>

  <!-- Learning Path Panel -->
  <div class="card tab-content" id="learning-path" style="display: none;">
    <div class="card-header">
      <i class="fas fa-graduation-cap"></i>
      <h2>Personalized Learning Path</h2>
    </div>
    
    <div class="progress-container">
      <div style="text-align: center; margin-bottom: 1rem;">
        <svg width="120" height="120" viewBox="0 0 120 120" class="progress-ring">
          <circle class="progress-ring-circle" stroke="#00bcd4" stroke-width="8" fill="transparent" r="52" cx="60" cy="60"
            stroke-dasharray="326.56" stroke-dashoffset="228.59" />
          <text x="60" y="65" text-anchor="middle" fill="white" font-size="16" font-weight="bold">65%</text>
        </svg>
        <div>Overall Progress</div>
      </div>
    </div>
    
    <div class="learning-path">
      <h4>Your Learning Journey:</h4>
      <div class="path-step">
        <div class="step-number">1</div>
        <div>
          <strong>Basic Syntax</strong>
          <div style="font-size: 0.9rem; opacity: 0.8;">Completed ‚úì</div>
        </div>
      </div>
      <div class="path-step">
        <div class="step-number">2</div>
        <div>
          <strong>Functions & Variables</strong>
          <div style="font-size: 0.9rem; opacity: 0.8;">Completed ‚úì</div>
        </div>
      </div>
      <div class="path-step">
        <div class="step-number">3</div>
        <div>
          <strong>Control Structures</strong>
          <div style="font-size: 0.9rem; opacity: 0.8;">In Progress (80%)</div>
        </div>
      </div>
      <div class="path-step">
        <div class="step-number">4</div>
        <div>
          <strong>Object-Oriented Programming</strong>
          <div style="font-size: 0.9rem; opacity: 0.8;">Next Step</div>
        </div>
      </div>
      <div class="path-step">
        <div class="step-number">5</div>
        <div>
          <strong>Advanced Algorithms</strong>
          <div style="font-size: 0.9rem; opacity: 0.8;">Locked</div>
        </div>
      </div>
    </div>
    
    <div class="ai-insights">
      <h4>AI Learning Insights:</h4>
      <div class="insight-item">
        <strong>üìä Pattern Detected:</strong> You're improving quickly with loop structures!
      </div>
      <div class="insight-item">
        <strong>üí° Recommendation:</strong> Practice with array methods to strengthen your skills.
      </div>
      <div class="insight-item">
        <strong>üéØ Focus Area:</strong> Pay attention to error handling in your functions.
      </div>
    </div>
  </div>

  <!-- Collaboration Panel -->
  <div class="card tab-content" id="collaboration" style="display: none;">
    <div class="card-header">
      <i class="fas fa-users"></i>
      <h2>Collaborative Coding</h2>
    </div>
    
    <div class="collaboration-panel">
      <h4>Live Collaboration</h4>
      <div class="user-list">
        <div class="user-item">
          <div class="user-avatar">Y</div>
          <div>You (Owner)</div>
        </div>
        <div class="user-item">
          <div class="user-avatar" style="background: #ff4081;">A</div>
          <div>AI Assistant</div>
        </div>
      </div>
      
      <button onclick="startLiveSession()" class="btn-primary" style="margin-top: 1rem; width: 100%;">
        <i class="fas fa-broadcast-tower"></i> Start Live Collaboration Session
      </button>
    </div>
    
    <div class="code-compare">
      <div class="compare-panel">
        <h4>Original Code</h4>
        <textarea style="height: 200px; background: #1a1a2e; color: white; width: 100%;" id="original-code">function example() {
  console.log("Hello World");
}</textarea>
      </div>
      <div class="compare-panel">
        <h4>AI Improved Code</h4>
        <textarea style="height: 200px; background: #1a1a2e; color: white; width: 100%;" id="improved-code">/**
 * Example function with improved documentation
 * @returns {void}
 */
function example() {
  // Use strict mode for better error handling
  'use strict';
  
  // More descriptive logging
  console.log("Hello World - Application initialized");
  
  // Return for consistency
  return;
}</textarea>
      </div>
    </div>
    
    <div class="version-control">
      <h4>Code Version History</h4>
      <div class="version-item active">
        <strong>Version 3.1</strong> - AI optimized with documentation
      </div>
      <div class="version-item">
        <strong>Version 3.0</strong> - Added error handling
      </div>
      <div class="version-item">
        <strong>Version 2.0</strong> - Refactored structure
      </div>
      <div class="version-item">
        <strong>Version 1.0</strong> - Initial implementation
      </div>
    </div>
  </div>

  <!-- Enhanced AI Features Panel -->
  <div class="card tab-content" id="ai-features" style="display: none;">
    <div class="card-header">
      <i class="fas fa-robot"></i>
      <h2>Advanced AI Features</h2>
    </div>
    
    <div class="feature-grid">
      <div class="feature-card" onclick="explainCode()">
        <div class="feature-icon"><i class="fas fa-info-circle"></i></div>
        <div class="feature-title">Explain Code</div>
        <div class="feature-desc">Get detailed explanations</div>
      </div>
      
      <div class="feature-card" onclick="refactorCode()">
        <div class="feature-icon"><i class="fas fa-sync-alt"></i></div>
        <div class="feature-title">Refactor Code</div>
        <div class="feature-desc">Improve code structure</div>
      </div>
      
      <div class="feature-card" onclick="optimizeCode()">
        <div class="feature-icon"><i class="fas fa-tachometer-alt"></i></div>
        <div class="feature-title">Optimize Code</div>
        <div class="feature-desc">Performance improvements</div>
      </div>
      
      <div class="feature-card" onclick="addComments()">
        <div class="feature-icon"><i class="far fa-comment-dots"></i></div>
        <div class="feature-title">Add Comments</div>
        <div class="feature-desc">Documentation generation</div>
      </div>
      
      <div class="feature-card" onclick="translateCode()">
        <div class="feature-icon"><i class="fas fa-language"></i></div>
        <div class="feature-title">Translate Code</div>
        <div class="feature-desc">Between languages</div>
      </div>
      
      <div class="feature-card" onclick="suggestImprovements()">
        <div class="feature-icon"><i class="fas fa-lightbulb"></i></div>
        <div class="feature-title">Suggest Improvements</div>
        <div class="feature-desc">AI recommendations</div>
      </div>
      
      <!-- New AI Features -->
      <div class="feature-card" onclick="codeReview()">
        <div class="feature-icon"><i class="fas fa-search"></i></div>
        <div class="feature-title">Code Review</div>
        <div class="feature-desc">Comprehensive analysis</div>
      </div>
      
      <div class="feature-card" onclick="generateTests()">
        <div class="feature-icon"><i class="fas fa-vial"></i></div>
        <div class="feature-title">Generate Tests</div>
        <div class="feature-desc">Unit test creation</div>
      </div>
      
      <div class="feature-card" onclick="detectPatterns()">
        <div class="feature-icon"><i class="fas fa-project-diagram"></i></div>
        <div class="feature-title">Detect Patterns</div>
        <div class="feature-desc">Identify code patterns</div>
      </div>
      
      <div class="feature-card" onclick="securityScan()">
        <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
        <div class="feature-title">Security Scan</div>
        <div class="feature-desc">Vulnerability detection</div>
      </div>
      
      <div class="feature-card" onclick="performanceAnalysis()">
        <div class="feature-icon"><i class="fas fa-chart-line"></i></div>
        <div class="feature-title">Performance Analysis</div>
        <div class="feature-desc">Runtime optimization</div>
      </div>
      
      <div class="feature-card" onclick="codeVisualization()">
        <div class="feature-icon"><i class="fas fa-code-branch"></i></div>
        <div class="feature-title">Code Visualization</div>
        <div class="feature-desc">Structure diagrams</div>
      </div>
    </div>
    
    <div class="code-metrics">
      <div class="metric-card">
        <div>Code Quality</div>
        <div class="metric-value">87%</div>
        <div>Based on best practices</div>
      </div>
      <div class="metric-card">
        <div>Complexity</div>
        <div class="metric-value">Medium</div>
        <div>Cyclomatic analysis</div>
      </div>
      <div class="metric-card">
        <div>Maintainability</div>
        <div class="metric-value">92%</div>
        <div>Ease of maintenance</div>
      </div>
      <div class="metric-card">
        <div>Performance</div>
        <div class="metric-value">Good</div>
        <div>Runtime efficiency</div>
      </div>
    </div>
    
    <div class="loader" id="ai-loader">
      <div class="spinner"></div>
      <p>Processing...</p>
    </div>
    
    <div class="output-header">
      <h3>AI Results:</h3>
    </div>
    <pre id="ai-output">üí° AI results will appear here...</pre>
  </div>

  <!-- Rest of the existing code remains exactly the same -->
  <!-- Only adding the new JavaScript functions below -->

<script>
// =============================================
// NEW AI FEATURES IMPLEMENTATION
// =============================================

// AI Chat Assistant
function sendChatMessage() {
  const input = document.getElementById('chat-input');
  const message = input.value.trim();
  
  if (!message) return;
  
  // Add user message to chat
  addChatMessage(message, 'user');
  input.value = '';
  
  // Show AI typing indicator
  const typingIndicator = addChatMessage('AI is thinking...', 'ai');
  
  // Simulate AI response delay
  setTimeout(() => {
    // Remove typing indicator
    typingIndicator.remove();
    
    // Generate AI response
    const response = generateAIResponse(message);
    addChatMessage(response, 'ai');
  }, 1500);
}

function addChatMessage(message, sender) {
  const container = document.getElementById('chat-messages');
  const messageDiv = document.createElement('div');
  messageDiv.className = `chat-message ${sender}-message`;
  
  if (sender === 'user') {
    messageDiv.innerHTML = `<strong>You:</strong> ${message}`;
  } else {
    messageDiv.innerHTML = `<strong>AI Assistant:</strong> ${message}`;
  }
  
  container.appendChild(messageDiv);
  container.scrollTop = container.scrollHeight;
  
  return messageDiv;
}

function askSuggestion(question) {
  document.getElementById('chat-input').value = question;
  sendChatMessage();
}

function generateAIResponse(message) {
  const lowerMessage = message.toLowerCase();
  const code = document.getElementById("code").value;
  
  // AI response patterns
  if (lowerMessage.includes('error') || lowerMessage.includes('fix')) {
    return `I can help you fix that error. Based on your code, I notice ${getCodeIssues(code)}. Try ${getFixSuggestions(code)}`;
  } else if (lowerMessage.includes('explain') || lowerMessage.includes('what does')) {
    return `This code appears to ${getCodeExplanation(code)}. The main purpose is ${getCodePurpose(code)}`;
  } else if (lowerMessage.includes('optimize') || lowerMessage.includes('improve')) {
    return `Here's how to optimize your code: ${getOptimizationTips(code)}`;
  } else if (lowerMessage.includes('example') || lowerMessage.includes('show me')) {
    return `Here's an example:\n\n${getCodeExample(lowerMessage)}`;
  } else if (lowerMessage.includes('learn') || lowerMessage.includes('study')) {
    return `Based on your current progress, I recommend focusing on ${getLearningRecommendation()}`;
  } else {
    return `I understand you're asking about "${message}". As an AI programming assistant, I can help you with code explanations, debugging, optimization, and learning guidance. Could you provide more details about what you'd like to know?`;
  }
}

// New Advanced AI Features
function codeReview() {
  showAILoader(true);
  setTimeout(() => {
    const code = document.getElementById("code").value;
    const review = performCodeReview(code);
    showAIOutput(review, "success");
    showAILoader(false);
  }, 2000);
}

function generateTests() {
  showAILoader(true);
  setTimeout(() => {
    const code = document.getElementById("code").value;
    const tests = generateUnitTests(code);
    document.getElementById("code").value = tests;
    showAIOutput("‚úÖ Unit tests generated successfully! Added to code editor.", "success");
    showAILoader(false);
  }, 2000);
}

function detectPatterns() {
  showAILoader(true);
  setTimeout(() => {
    const code = document.getElementById("code").value;
    const patterns = analyzeCodePatterns(code);
    showAIOutput(patterns, "success");
    showAILoader(false);
  }, 1500);
}

function securityScan() {
  showAILoader(true);
  setTimeout(() => {
    const code = document.getElementById("code").value;
    const securityIssues = performSecurityScan(code);
    showAIOutput(securityIssues, securityIssues.includes("‚ùå") ? "error" : "success");
    showAILoader(false);
  }, 2000);
}

function performanceAnalysis() {
  showAILoader(true);
  setTimeout(() => {
    const code = document.getElementById("code").value;
    const analysis = analyzePerformance(code);
    showAIOutput(analysis, "success");
    showAILoader(false);
  }, 1800);
}

function codeVisualization() {
  showAILoader(true);
  setTimeout(() => {
    const code = document.getElementById("code").value;
    const visualization = generateCodeVisualization(code);
    showAIOutput(visualization, "success");
    showAILoader(false);
  }, 2500);
}

// Collaboration Features
function startLiveSession() {
  showOutput("üîÑ Starting live collaboration session... AI Assistant joined.", "success");
  setTimeout(() => {
    showOutput("‚úÖ Live session active! You can now collaborate in real-time with AI suggestions.", "success");
  }, 1000);
}

// Helper functions for AI features
function getCodeIssues(code) {
  const issues = [];
  if (code.includes("eval(")) issues.push("potential security issues with eval()");
  if (code.includes("innerHTML")) issues.push("XSS vulnerabilities with innerHTML");
  if (code.match(/for\s*\(.*;.*;.*\)/)) issues.push("possible performance issues with loops");
  if (code.includes("console.log") && !code.includes("development")) issues.push("debugging code in production");
  
  return issues.length > 0 ? issues.join(", ") : "no major issues detected";
}

function getFixSuggestions(code) {
  if (code.includes("eval(")) return "using JSON.parse() or Function constructor instead of eval()";
  if (code.includes("innerHTML")) return "using textContent or createElement instead of innerHTML";
  if (code.match(/for\s*\(.*;.*;.*\)/)) return "using array methods like forEach or map for better performance";
  
  return "reviewing the error message and checking variable names";
}

function getCodeExplanation(code) {
  if (code.includes("document.createElement")) return "create dynamic HTML elements";
  if (code.includes("addEventListener")) return "handle user interactions";
  if (code.includes("fetch") || code.includes("XMLHttpRequest")) return "make HTTP requests";
  if (code.includes("class ") || code.includes("function ")) return "define reusable code structures";
  
  return "perform operations based on your implementation";
}

function getCodePurpose(code) {
  if (code.includes("button") && code.includes("click")) return "handle user button clicks";
  if (code.includes("localStorage")) return "store data in the browser";
  if (code.includes("setInterval") || code.includes("setTimeout")) return "execute code after delays or repeatedly";
  if (code.includes("JSON.parse")) return "process JSON data";
  
  return "implement the functionality you described";
}

function getOptimizationTips(code) {
  const tips = [];
  if (code.includes("document.getElementById") inside loops) tips.push("cache DOM elements outside loops");
  if (code.includes("innerHTML") for simple text) tips.push("use textContent instead of innerHTML for better performance");
  if (code.match(/function\s+\w+\s*\(\)\s*\{/g)?.length > 5) tips.push("consider breaking large functions into smaller ones");
  if (!code.includes("use strict")) tips.push("add 'use strict' for better error checking");
  
  return tips.length > 0 ? tips.join(", ") : "your code is already well-optimized!";
}

function getCodeExample(query) {
  if (query.includes("array")) return `// Array manipulation example\nconst numbers = [1, 2, 3, 4, 5];\nconst doubled = numbers.map(n => n * 2);\nconst even = numbers.filter(n => n % 2 === 0);\nconsole.log(doubled); // [2, 4, 6, 8, 10]`;
  if (query.includes("function")) return `// Function example\nfunction calculateArea(width, height) {\n  return width * height;\n}\nconst area = calculateArea(5, 10);\nconsole.log(area); // 50`;
  if (query.includes("event")) return `// Event handling example\ndocument.getElementById('myButton').addEventListener('click', function() {\n  alert('Button clicked!');\n});`;
  
  return `// Basic example\nconsole.log("Hello, World!");\nconst name = "AI Assistant";\nconsole.log(\`Hello, \${name}!\`);`;
}

function getLearningRecommendation() {
  const recommendations = [
    "asynchronous programming with promises and async/await",
    "object-oriented programming principles",
    "functional programming concepts",
    "DOM manipulation techniques",
    "API integration and data fetching"
  ];
  return recommendations[Math.floor(Math.random() * recommendations.length)];
}

function performCodeReview(code) {
  return `üîç CODE REVIEW RESULTS:

üìä CODE QUALITY: 85/100
‚úÖ STRENGTHS:
‚Ä¢ Good variable naming conventions
‚Ä¢ Proper indentation and formatting
‚Ä¢ Logical code structure

‚ö†Ô∏è AREAS FOR IMPROVEMENT:
${getImprovementSuggestions(code)}

üéØ RECOMMENDATIONS:
1. Add error handling for edge cases
2. Consider using more descriptive function names
3. Add input validation where needed
4. Include code comments for complex logic

üí° BEST PRACTICES:
‚Ä¢ Use const for variables that won't be reassigned
‚Ä¢ Prefer template literals over string concatenation
‚Ä¢ Consider using modern ES6+ features`;
}

function generateUnitTests(code) {
  return `// Generated Unit Tests\n${code}\n\n// TEST SUITE\ndescribe('Code Functionality', () => {\n  beforeEach(() => {\n    // Setup before each test\n  });\n\n  test('should execute without errors', () => {\n    expect(() => {\n      // Your code execution\n    }).not.toThrow();\n  });\n\n  test('should return expected results', () => {\n    // Add specific test cases based on your code\n    expect(true).toBe(true);\n  });\n\n  afterEach(() => {\n    // Cleanup after each test\n  });\n});`;
}

function analyzeCodePatterns(code) {
  return `üîç CODE PATTERN ANALYSIS:

üìà DETECTED PATTERNS:
‚Ä¢ ${code.includes('function') ? 'Function declarations' : 'Procedural code'}
‚Ä¢ ${code.includes('class') ? 'Object-oriented patterns' : 'Functional patterns'}
‚Ä¢ ${code.includes('=>') ? 'Arrow function usage' : 'Traditional function usage'}
‚Ä¢ ${code.includes('const') || code.includes('let') ? 'Modern variable declarations' : 'Traditional variable declarations'}

üé® ARCHITECTURAL INSIGHTS:
${getArchitecturalInsights(code)}

üîÑ COMMON PATTERNS IDENTIFIED:
${getCommonPatterns(code)}`;
}

function performSecurityScan(code) {
  const issues = [];
  
  if (code.includes("eval(")) issues.push("‚ùå eval() usage - security risk");
  if (code.includes("innerHTML") && !code.includes("textContent")) issues.push("‚ö†Ô∏è innerHTML usage - potential XSS vulnerability");
  if (code.includes("localStorage") && code.includes("password")) issues.push("‚ùå Storing passwords in localStorage - insecure");
  if (code.includes("XMLHttpRequest") && !code.includes("https")) issues.push("‚ö†Ô∏è Non-HTTPS requests - security risk");
  
  if (issues.length === 0) {
    return "‚úÖ SECURITY SCAN PASSED: No critical security issues detected";
  } else {
    return `üîí SECURITY SCAN RESULTS:\n\n${issues.join('\n')}\n\nüí° RECOMMENDATIONS:\n‚Ä¢ Avoid eval() and innerHTML with user input\n‚Ä¢ Use HTTPS for all requests\n‚Ä¢ Never store sensitive data in localStorage`;
  }
}

function analyzePerformance(code) {
  return `üìä PERFORMANCE ANALYSIS:

‚ö° PERFORMANCE SCORE: 78/100

‚úÖ OPTIMIZATIONS DETECTED:
‚Ä¢ Efficient DOM query caching
‚Ä¢ Proper event listener management

‚ö†Ô∏è PERFORMANCE BOTTLENECKS:
${getPerformanceBottlenecks(code)}

üéØ OPTIMIZATION SUGGESTIONS:
1. Minimize DOM manipulations in loops
2. Use event delegation for multiple elements
3. Consider lazy loading for heavy operations
4. Implement debouncing for frequent events

üìà PERFORMANCE METRICS:
‚Ä¢ Estimated execution time: < 50ms
‚Ä¢ Memory usage: Low
‚Ä¢ CPU impact: Minimal`;
}

function generateCodeVisualization(code) {
  return `üìä CODE STRUCTURE VISUALIZATION:

üèóÔ∏è  ARCHITECTURE OVERVIEW:
[Main Function] ‚Üí [Helper Functions] ‚Üí [DOM Operations]

üîó DEPENDENCY GRAPH:
${getDependencyGraph(code)}

üìù CODE METRICS:
‚Ä¢ Lines of code: ${code.split('\n').length}
‚Ä¢ Functions: ${(code.match(/function/g) || []).length}
‚Ä¢ Variables: ${(code.match(/(const|let|var)\s+\w+/g) || []).length}
‚Ä¢ Complexity: ${getComplexityLevel(code)}

üîÑ DATA FLOW:
${getDataFlow(code)}`;
}

// Additional helper functions
function getImprovementSuggestions(code) {
  const suggestions = [];
  if (!code.includes("try") && !code.includes("catch")) suggestions.push("‚Ä¢ Add error handling with try/catch");
  if (code.includes("==") && !code.includes("===")) suggestions.push("‚Ä¢ Use strict equality (===) instead of loose equality (==)");
  if (code.match(/var\s+\w+/)) suggestions.push("‚Ä¢ Replace var with let/const for better scoping");
  
  return suggestions.length > 0 ? suggestions.join('\n') : "‚Ä¢ No major improvements needed";
}

function getArchitecturalInsights(code) {
  if (code.includes("class ")) return "‚Ä¢ Object-oriented architecture detected\n‚Ä¢ Good encapsulation practices";
  if (code.includes("function") && code.includes("=>")) return "‚Ä¢ Functional programming patterns\n‚Ä¢ Modern JavaScript practices";
  return "‚Ä¢ Procedural code structure\n‚Ä¢ Consider modularizing with functions";
}

function getCommonPatterns(code) {
  const patterns = [];
  if (code.includes("addEventListener")) patterns.push("‚Ä¢ Event-driven architecture");
  if (code.includes("fetch") || code.includes("axios")) patterns.push("‚Ä¢ API integration pattern");
  if (code.includes("Promise") || code.includes("async")) patterns.push("‚Ä¢ Asynchronous programming");
  if (code.includes("document.")) patterns.push("‚Ä¢ DOM manipulation pattern");
  
  return patterns.length > 0 ? patterns.join('\n') : "‚Ä¢ Basic programming patterns";
}

function getPerformanceBottlenecks(code) {
  const bottlenecks = [];
  if (code.match(/document\..*\(.*\)/g)?.length > 5) bottlenecks.push("‚Ä¢ Multiple DOM queries - consider caching");
  if (code.includes("setInterval")) bottlenecks.push("‚Ä¢ Continuous intervals - ensure proper cleanup");
  if (code.includes("JSON.parse") inside loops) bottlenecks.push("‚Ä¢ Repeated JSON parsing - parse once and reuse");
  
  return bottlenecks.length > 0 ? bottlenecks.join('\n') : "‚Ä¢ No significant bottlenecks detected";
}

function getDependencyGraph(code) {
  if (code.includes("function")) return "‚îî‚îÄ‚îÄ Main\n    ‚îú‚îÄ‚îÄ Helper Functions\n    ‚îî‚îÄ‚îÄ Event Handlers";
  return "‚îî‚îÄ‚îÄ Linear execution flow";
}

function getComplexityLevel(code) {
  const lines = code.split('\n').length;
  const functions = (code.match(/function/g) || []).length;
  
  if (lines < 20 && functions < 3) return "Low";
  if (lines < 50 && functions < 5) return "Medium";
  return "High";
}

function getDataFlow(code) {
  if (code.includes("input") && code.includes("output")) return "Input ‚Üí Processing ‚Üí Output";
  if (code.includes("event")) return "Event ‚Üí Handler ‚Üí DOM Update";
  return "Data ‚Üí Transformation ‚Üí Result";
}

// =============================================
// EXISTING FUNCTIONS REMAIN EXACTLY THE SAME
// =============================================

// All your previous functions (runCode, generateCode, etc.) remain unchanged
// Only new functions were added above

</script>
</body>
</html>
